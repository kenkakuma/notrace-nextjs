# CMS利用ガイド - NO TRACE EXPLORER

> 最終更新: 2025-01-15
> バージョン: v0.4.0

## 📋 目次

- [概要](#概要)
- [CMSアクセス方法](#cmsアクセス方法)
- [企業文章の管理](#企業文章の管理)
- [ニュースの管理](#ニュースの管理)
- [画像の管理](#画像の管理)
- [公開ワークフロー](#公開ワークフロー)
- [トラブルシューティング](#トラブルシューティング)

---

## 概要

### システム構成

NO TRACE EXPLORERのCMSシステムは以下の2つのツールで構成されています：

1. **Sveltia CMS** - ユーザーフレンドリーな管理画面
2. **Contentlayer** - MDX形式のコンテンツ処理

### コンテンツタイプ

- **企業文章 (Articles)**: コーヒー事業、サービス、技術に関する詳細な記事
- **ニュース (News)**: プレスリリース、お知らせ、イベント情報
- **Hero背景**: トップページのHeroセクション設定

---

## CMSアクセス方法

### 開発環境

1. **開発サーバーを起動**
   ```bash
   npm run dev
   ```

2. **CMS管理画面にアクセス**
   ```
   http://localhost:3000/admin
   ```

3. **認証**
   - 初回アクセス時: GitHubアカウントで認証
   - ローカル開発モード: 認証なしで使用可能

### 本番環境

```
https://no-trace.jp/admin
```

**要件**:
- GitHubアカウント
- リポジトリへの書き込み権限

---

## 企業文章の管理

### 新規文章の作成

1. CMS管理画面で「**企業文章**」セクションを選択
2. 「**新しい企業文章**」ボタンをクリック
3. 以下の項目を入力：

#### 必須項目

| 項目 | 説明 | 例 |
|------|------|-----|
| タイトル | 記事のタイトル（80文字以内推奨） | 日中コーヒー文化の融合 |
| 説明 | 記事の要約（160文字以内推奨） | 日本と中国のコーヒー文化の特徴を比較分析 |
| 公開日 | 記事の公開日時 | 2025-01-22 14:00 |
| カテゴリー | 以下から選択 | コーヒー事業 |
| 著者 | 記事の著者名 | NO TRACE EXPLORER |
| 本文 | Markdown形式の記事本文 | ## 見出し... |

#### カテゴリー選択肢

- 企業ニュース
- サービス
- コーヒー事業
- 展示・イベント
- 釣具・器具
- その他

#### 任意項目

| 項目 | 説明 | 使用例 |
|------|------|--------|
| 抜粋 | リスト表示用の短い概要 | スペシャルティコーヒーの基準を解説 |
| アイキャッチ画像 | 記事のサムネイル画像 | /uploads/coffee-culture.jpg |
| 読了時間 | 読むのにかかる時間 | 8分 |
| タグ | 検索用タグ（複数可） | コーヒー文化, 日中ビジネス |
| 注目記事 | トップページに表示 | ✓ |
| 公開状態 | 公開/非公開 | ✓ 公開 |

### 記事本文の書き方

#### Markdown基本構文

```markdown
## 大見出し

### 中見出し

通常のテキストはそのまま書きます。

**太字** や *斜体* も使えます。

- リスト項目1
- リスト項目2

1. 番号付きリスト
2. 項目2

[リンクテキスト](https://example.com)

![画像の説明](/uploads/image.jpg)
```

#### コードブロック

````markdown
```javascript
const coffee = {
  name: 'Ethiopian Yirgacheffe',
  roast: 'Light'
}
```
````

#### 引用

```markdown
> これは引用文です。
> 複数行にわたって書けます。
```

### 文章の編集

1. 「企業文章」リストから編集したい記事を選択
2. 内容を編集
3. 「保存」ボタンをクリック
4. 変更がGitにコミットされます

### 文章の削除

1. 削除したい記事を選択
2. 「削除」ボタンをクリック
3. 確認ダイアログで承認

⚠️ **注意**: 削除は永久的です。必要に応じてバックアップを取ってください。

---

## ニュースの管理

### 新規ニュースの作成

企業文章と同様の手順ですが、以下の点が異なります：

#### ニュース専用項目

| 項目 | 説明 | 使用例 |
|------|------|--------|
| 外部リンク | 外部サイトへのURL（任意） | https://prtimes.jp/... |

#### カテゴリー選択肢

- プレスリリース
- お知らせ
- イベント情報
- メディア掲載

### 外部リンクの使い方

メディア掲載などで、外部サイトの記事にリンクしたい場合：

1. 「外部リンク」フィールドに完全なURLを入力
2. タイトルと説明は簡潔に
3. 本文には要約を記載

**動作**:
- リストページ: カード形式で表示、外部リンクアイコン付き
- クリック時: 新しいタブで外部サイトを開く

### プレスリリースのベストプラクティス

```markdown
## プレスリリーステンプレート

### 【タイトル】
会社設立、新サービス開始など

### 【本文】
1. リード文（要約）
2. 背景・経緯
3. 詳細情報
4. 今後の展望
5. 会社概要

### 【お問い合わせ先】
会社名
Email: info@no-trace.jp
```

---

## 画像の管理

### Cloudinary連携

CMS では Cloudinary を使用して画像を管理します。

### 画像のアップロード

1. **記事編集画面で「アイキャッチ画像」をクリック**
2. **「アップロード」タブを選択**
3. **画像ファイルをドラッグ&ドロップまたは選択**
4. **アップロード完了後、URLが自動的に挿入されます**

### 推奨画像仕様

| 用途 | 推奨サイズ | 最大ファイルサイズ | 形式 |
|------|------------|-------------------|------|
| アイキャッチ画像 | 1200 x 630 px | 1 MB | JPG, PNG |
| 本文中の画像 | 800 x 600 px | 500 KB | JPG, PNG |
| アイコン | 200 x 200 px | 100 KB | PNG, SVG |

### 画像の最適化

アップロード前に以下を確認：

- ✅ 適切なサイズにリサイズ
- ✅ 不要な透明度を削除
- ✅ 適切な圧縮率を設定
- ✅ SEO用のファイル名（例: coffee-beans-ethiopia.jpg）

### 本文中に画像を挿入

```markdown
![画像の説明](/uploads/image-name.jpg)
```

**説明**:
- `画像の説明`: SEO とアクセシビリティのための代替テキスト
- `/uploads/...`: Cloudinaryからの画像URL

---

## 公開ワークフロー

### 下書きから公開まで

```
1. 下書き作成
   ↓ 公開状態: OFF
2. 内容確認
   ↓ プレビュー機能で確認
3. 公開
   ↓ 公開状態: ON
4. サイトに反映
   ↓ 自動ビルド（5-10分）
5. 確認
   ↓ 実際のサイトで確認
```

### 公開前チェックリスト

- [ ] タイトルが適切か
- [ ] 説明文が分かりやすいか
- [ ] カテゴリーが正しいか
- [ ] 画像が正しく表示されるか
- [ ] リンクが正しく動作するか
- [ ] 誤字脱字がないか
- [ ] 公開日時が正しいか

### 公開後の確認

1. **トップページで確認**
   - 最新5件に表示されているか

2. **記事一覧で確認**
   - `/articles` または `/news` で正しく表示されているか

3. **記事詳細で確認**
   - 本文が正しくレンダリングされているか
   - 画像が表示されているか

---

## トラブルシューティング

### よくある問題

#### 1. 画像が表示されない

**原因**:
- 画像URLが間違っている
- Cloudinaryの設定問題
- 画像ファイルが大きすぎる

**解決方法**:
1. URLが `/uploads/` で始まっているか確認
2. Cloudinaryダッシュボードで画像が存在するか確認
3. 画像サイズを1MB以下に圧縮

#### 2. 記事が公開されない

**原因**:
- 「公開状態」がOFFになっている
- ビルドエラー
- 必須項目が未入力

**解決方法**:
1. 「公開状態」をONにする
2. すべての必須項目を入力
3. 5-10分待ってから再確認

#### 3. Markdownが正しく表示されない

**原因**:
- 構文エラー
- サポートされていない構文

**解決方法**:
1. Markdown構文を確認
2. プレビュー機能で事前確認
3. 本ガイドの「記事本文の書き方」を参照

#### 4. タグが機能しない

**原因**:
- タグの形式が間違っている

**解決方法**:
- タグは1つずつ追加
- スペースや特殊文字を避ける

### エラーメッセージ

| エラー | 意味 | 対処法 |
|--------|------|--------|
| `Required field` | 必須項目が未入力 | すべての必須項目を入力 |
| `Invalid date` | 日付形式が不正 | 正しい日付形式で入力 |
| `Upload failed` | 画像アップロード失敗 | ファイルサイズを確認 |

### サポート連絡先

技術的な問題が解決しない場合：

**開発チーム**
- Email: dev@no-trace.jp
- Slack: #cms-support

---

## ベストプラクティス

### 記事作成のコツ

1. **タイトル**
   - 40-60文字が理想
   - キーワードを含める
   - 具体的で分かりやすく

2. **説明文**
   - 120-160文字
   - 記事の要点を簡潔に
   - 読者の興味を引く

3. **本文構成**
   - 見出しで構造化
   - 段落は3-5文
   - 適度に画像を挿入

4. **SEO対策**
   - 適切なタグ付け
   - 画像のalt属性
   - 内部リンクの活用

### 更新頻度の推奨

- **ニュース**: 週1-2回
- **企業文章**: 月2-4回
- **注目記事**: 月1回更新

### メンテナンス

- 月1回: 古い記事の見直し
- 四半期: アーカイブの整理
- 年1回: カテゴリー構成の見直し

---

## 付録

### Markdown チートシート

```markdown
# H1見出し
## H2見出し
### H3見出し

**太字**
*斜体*
~~取り消し線~~

[リンク](URL)
![画像](URL)

- 箇条書き
1. 番号リスト

> 引用

`インラインコード`

\`\`\`
コードブロック
\`\`\`

---
水平線
```

### よく使うコマンド

```bash
# 開発サーバー起動
npm run dev

# ビルド
npm run build

# CMS管理画面
http://localhost:3000/admin

# 記事確認
http://localhost:3000/articles
http://localhost:3000/news
```

---

**このガイドは継続的に更新されます**

**最終更新**: 2025-01-15
**バージョン**: v0.4.0
**作成者**: NO TRACE EXPLORER 開発チーム
